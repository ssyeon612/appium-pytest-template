name: Android Real Device Clock Test

on:
  push:
    branches: [ master ]

jobs:
  android-test:
    runs-on: self-hosted

    steps:
    - name: Checkout Code
      uses: actions/checkout@v3

    - name: Run Clock App Test
      run: |
        adb devices
        adb shell am start -n com.sec.android.app.clockpackage/com.sec.android.app.clockpackage.ClockPackage

        # 스크린샷 저장
        adb shell screencap -p /sdcard/clock_screen.png
        adb pull /sdcard/clock_screen.png ./clock_screen.png

    - name: Upload Screenshot as Artifact
      uses: actions/upload-artifact@v3
      with:
        name: clock_screen
        path: ./clock_screen.png

    - name: Notify Slack
      run: |
        curl -X POST -H 'Content-type: application/json' \
          --data '{
            "text":"✅ Android Clock Test 완료! 스크린샷: ${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}"
          }' \
          ${{ secrets.SLACK_WEBHOOK_URL }}
